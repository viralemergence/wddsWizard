<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>WDDS to Zenodo • wddsWizard</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png">
<link rel="icon" type="”image/svg+xml”" href="../favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png">
<link rel="icon" sizes="any" href="../favicon.ico">
<link rel="manifest" href="../site.webmanifest">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="WDDS to Zenodo">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">wddsWizard</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.2.2</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/wddsWizard.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/disease_data.html">Wildlife Disease Data</a></li>
    <li><a class="dropdown-item" href="../articles/extending_wdds.html">Extending the Wildlife Disease Data Standard</a></li>
    <li><a class="dropdown-item" href="../articles/project_metadata.html">Project Metadata</a></li>
    <li><a class="dropdown-item" href="../articles/schema_overview.html">Schema Overview</a></li>
    <li><a class="dropdown-item" href="../articles/wdds_to_pharos.html">WDDS to Pharos</a></li>
    <li><a class="dropdown-item" href="../articles/wdds_to_zenodo.html">WDDS to Zenodo</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/viralemergence/wddsWizard/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.svg" class="logo" alt=""><h1>WDDS to Zenodo</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/viralemergence/wddsWizard/blob/main/vignettes/wdds_to_zenodo.Rmd" class="external-link"><code>vignettes/wdds_to_zenodo.Rmd</code></a></small>
      <div class="d-none name"><code>wdds_to_zenodo.Rmd</code></div>
    </div>

    
    
<p>The Wildlife Disease Data Standard (WDDS) aims to make data Findable
Accessible Interoperable and Re-useable (FAIR). A big part of making
data findable is 1) depositing it in an archive that can be searched and
2) providing metadata to improve discoverability. By depositing data in
a generalist repository like Zenodo, you are placing it into an archive
that is free to access, widely used, searchable and extremely durable.
By using WDDS, your data will be interpretable to others increasing
re-usability.</p>
<p>This vignette will walk through depositing data validated against the
WDDS standard into Zenodo using the <a href="https://github.com/ropenscilabs/deposits" class="external-link">deposits package</a> to
create an interoperable <a href="https://datapackage.org/standard/data-package/" class="external-link">Frictionless data
package</a>.</p>
<div class="section level2">
<h2 id="what-is-zenodo">What is Zenodo?<a class="anchor" aria-label="anchor" href="#what-is-zenodo"></a>
</h2>
<p><a href="https://about.zenodo.org/" class="external-link">Zenodo</a> is a generalist data
repository with long term support and broad use across scientific
disciplines.</p>
<p>Key Features:</p>
<ol style="list-style-type: decimal">
<li>Long term funding (50 year funding horizon)</li>
<li>DOI minting and Robust data versioning</li>
<li>Users can upload files as large as 50 gb</li>
<li>Robust metadata that improve discovery</li>
<li>
<a href="https://developers.zenodo.org/" class="external-link">Well documented API</a> for
programmatic interaction</li>
</ol>
<p>We like Zenodo because it provides a stable place to deposit
data.</p>
<div class="section level3">
<h3 id="whats-the-difference-between-wdds-project-metadata-and-zenodo-deposit-metadata">Whats the difference between WDDS project metadata and Zenodo
deposit metadata?<a class="anchor" aria-label="anchor" href="#whats-the-difference-between-wdds-project-metadata-and-zenodo-deposit-metadata"></a>
</h3>
<p>The difference between WDDS and Zenodo is that WDDS uses <a href="https://datacite-metadata-schema.readthedocs.io/en/4.6/" class="external-link">datacite
terms</a> and the Zenodo API largely uses <a href="https://www.dublincore.org/specifications/dublin-core/dcmi-terms/" class="external-link">DCMI
terms</a>. This can cause confusion because certain terms are false
cognates - e.g. rights vs license.</p>
</div>
<div class="section level3">
<h3 id="read-in-project-metadata">Read in project metadata<a class="anchor" aria-label="anchor" href="#read-in-project-metadata"></a>
</h3>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://viralemergence.github.io/wddsWizard/">wddsWizard</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://docs.ropensci.org/deposits/" class="external-link">deposits</a></span><span class="op">)</span></span></code></pre></div>
<p>In this tutorial, we will assume you’ve used the project metadata
template to create your metadata.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">project_metadata</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/wdds_example_data.html">wdds_example_data</a></span><span class="op">(</span>version <span class="op">=</span> <span class="st">"latest"</span>, file <span class="op">=</span> <span class="st">"example_project_metadata.csv"</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>Unlike validating against the WDDS template, we do NOT want to prep
the data for JSON. The <code>deposits</code> package will essentially do
that for us.</p>
<p>Make sure <code>json_prep = FALSE</code>.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Do NOT prep the data for json!! The data is stored in a more consistent fashion if don't do the json prep, making it easier to convert to dcmi/zenodo form </span></span>
<span><span class="va">project_metadata_prepped</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/prep_from_metadata_template.html">prep_from_metadata_template</a></span><span class="op">(</span><span class="va">project_metadata</span>,json_prep <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># The DOI is random and will cause problems</span></span>
<span><span class="co"># drop the identifier since its not actually related to our data</span></span>
<span><span class="co"># If you have a Zenodo issued DOI already for your data it should be fine.</span></span>
<span><span class="va">drop_identifier</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">project_metadata_prepped</span><span class="op">)</span> <span class="op">==</span> <span class="st">"identifier"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">project_metadata_prepped</span> <span class="op">&lt;-</span> <span class="va">project_metadata_prepped</span><span class="op">[</span><span class="op">-</span><span class="va">drop_identifier</span><span class="op">]</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="map-fields-to-dcmi">Map fields to DCMI<a class="anchor" aria-label="anchor" href="#map-fields-to-dcmi"></a>
</h3>
<p>This is done using the <code>wdds_to_dcmi</code> function. For the
curious, you can look at the <code>wdds_to_dcmi_map</code> dataset or
the <code>wdds_zenodo_map.json</code> file included in with the package
to see how properties are mapped from one standard to the other.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/conditions.html" class="external-link">tryCatch</a></span><span class="op">(</span></span>
<span><span class="va">dcmi_metadata</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/wdds_to_dcmi.html">wdds_to_dcmi</a></span><span class="op">(</span>metadata_to_translate <span class="op">=</span> <span class="va">project_metadata_prepped</span>, translation_map <span class="op">=</span> <span class="va">wdds_to_dcmi_map</span><span class="op">)</span>,</span>
<span>error <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">e</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">e</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #0000BB; font-weight: bold;">&lt;error/purrr_error_indexed&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BBBB00; font-weight: bold;">Error</span><span style="font-weight: bold;"> in </span><span style="color: #5555FF; font-weight: bold;">`map2()`</span><span style="font-weight: bold;">:</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> In index: 5.</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> With name: rights.</span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">Caused by error in </span><span style="color: #5555FF; font-weight: bold;">`purrr::map()`</span><span style="font-weight: bold;">:</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> In index: 1.</span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">Backtrace:</span></span></span>
<span><span class="co">#&gt; <span style="color: #555555;">     </span>▆</span></span>
<span><span class="co">#&gt; <span style="color: #555555;">  1. </span>├─<span style="font-weight: bold;">base</span>::tryCatch(...)</span></span>
<span><span class="co">#&gt; <span style="color: #555555;">  2. </span>│ <span style="color: #949494;">└─base (local) tryCatchList(expr, classes, parentenv, handlers)</span></span></span>
<span><span class="co">#&gt; <span style="color: #555555;">  3. </span>│   <span style="color: #949494;">└─base (local) tryCatchOne(expr, names, parentenv, handlers[[1L]])</span></span></span>
<span><span class="co">#&gt; <span style="color: #555555;">  4. </span>│     <span style="color: #949494;">└─base (local) doTryCatch(return(expr), name, parentenv, handler)</span></span></span>
<span><span class="co">#&gt; <span style="color: #555555;">  5. </span>├─<span style="font-weight: bold;">wddsWizard</span>::wdds_to_dcmi(...)</span></span>
<span><span class="co">#&gt; <span style="color: #555555;">  6. </span>│ <span style="color: #949494;">└─</span><span style="color: #949494; font-weight: bold;">purrr</span><span style="color: #949494;">::imap(...)</span></span></span>
<span><span class="co">#&gt; <span style="color: #555555;">  7. </span>│   <span style="color: #949494;">└─</span><span style="color: #5555FF; font-weight: bold;">purrr::map2(</span><span style="color: #949494;">.x, vec_index(.x), .f, ...</span><span style="color: #5555FF; font-weight: bold;">)</span></span></span>
<span><span class="co">#&gt; <span style="color: #555555;">  8. </span>│     <span style="color: #949494;">└─purrr:::map2_("list", .x, .y, .f, ..., .progress = .progress)</span></span></span>
<span><span class="co">#&gt; <span style="color: #555555;">  9. </span>│       <span style="color: #949494;">├─purrr:::with_indexed_errors(...)</span></span></span>
<span><span class="co">#&gt; <span style="color: #555555;"> 10. </span>│       <span style="color: #949494;">│ └─</span><span style="color: #949494; font-weight: bold;">base</span><span style="color: #949494;">::withCallingHandlers(...)</span></span></span>
<span><span class="co">#&gt; <span style="color: #555555;"> 11. </span>│       <span style="color: #949494;">├─</span><span style="color: #949494; font-weight: bold;">purrr</span><span style="color: #949494;">:::call_with_cleanup(...)</span></span></span>
<span><span class="co">#&gt; <span style="color: #555555;"> 12. </span>│       <span style="color: #949494;">└─</span><span style="color: #949494; font-weight: bold;">wddsWizard</span><span style="color: #949494;"> (local) .f(.x[[i]], .y[[i]], ...)</span></span></span>
<span><span class="co">#&gt; <span style="color: #555555;"> 13. </span>│         <span style="color: #949494;">└─wddsWizard::translate_to_dcmi(item = item, translation_map = x)</span></span></span>
<span><span class="co">#&gt; <span style="color: #555555;"> 14. </span>│           <span style="color: #949494;">└─</span><span style="color: #949494; font-weight: bold;">purrr</span><span style="color: #949494;">::map(...)</span></span></span>
<span><span class="co">#&gt; <span style="color: #555555;"> 15. </span>│             <span style="color: #949494;">└─purrr:::map_("list", .x, .f, ..., .progress = .progress)</span></span></span>
<span><span class="co">#&gt; <span style="color: #555555;"> 16. </span>│               <span style="color: #949494;">├─purrr:::with_indexed_errors(...)</span></span></span>
<span><span class="co">#&gt; <span style="color: #555555;"> 17. </span>│               <span style="color: #949494;">│ └─</span><span style="color: #949494; font-weight: bold;">base</span><span style="color: #949494;">::withCallingHandlers(...)</span></span></span>
<span><span class="co">#&gt; <span style="color: #555555;"> 18. </span>│               <span style="color: #949494;">├─</span><span style="color: #949494; font-weight: bold;">purrr</span><span style="color: #949494;">:::call_with_cleanup(...)</span></span></span>
<span><span class="co">#&gt; <span style="color: #555555;"> 19. </span>│               <span style="color: #949494;">└─</span><span style="color: #949494; font-weight: bold;">wddsWizard</span><span style="color: #949494;"> (local) .f(.x[[i]], ...)</span></span></span>
<span><span class="co">#&gt; <span style="color: #555555;"> 20. </span>│                 <span style="color: #949494;">└─wddsWizard::wdds_to_dcmi(metadata_to_translate = x, translation_map = translation_map)</span></span></span>
<span><span class="co">#&gt; <span style="color: #555555;"> 21. </span>│                   <span style="color: #949494;">└─</span><span style="color: #949494; font-weight: bold;">rlang</span><span style="color: #949494;">::abort(message = msg)</span></span></span>
<span><span class="co">#&gt; <span style="color: #555555;"> 22. </span>│                     <span style="color: #949494;">└─rlang:::signal_abort(cnd, .file)</span></span></span>
<span><span class="co">#&gt; <span style="color: #555555;"> 23. </span>│                       <span style="color: #949494;">└─</span><span style="color: #949494; font-weight: bold;">base</span><span style="color: #949494;">::signalCondition(cnd)</span></span></span>
<span><span class="co">#&gt; <span style="color: #555555;"> 24. </span>└─<span style="font-weight: bold;">purrr</span> (local) `&lt;fn&gt;`(`&lt;rlng_rrr&gt;`)</span></span>
<span><span class="co">#&gt; <span style="color: #555555;"> 25. </span>  └─<span style="font-weight: bold;">cli</span>::cli_abort(...)</span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">Caused by error in </span><span style="color: #5555FF; font-weight: bold;">`wdds_to_dcmi()`</span><span style="font-weight: bold;">:</span></span></span>
<span><span class="co">#&gt; <span style="color: #BBBB00;">!</span> license - CC0 - not in wddsWizard::spdx_licenses$licenseId.</span></span>
<span><span class="co">#&gt;  Update the rights property in your data.</span></span>
<span><span class="co">#&gt;  Potential matches: CC0-1.0</span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">Backtrace:</span></span></span>
<span><span class="co">#&gt; <span style="color: #555555;">     </span>▆</span></span>
<span><span class="co">#&gt; <span style="color: #555555;">  1. </span>├─<span style="font-weight: bold;">base</span>::tryCatch(...)</span></span>
<span><span class="co">#&gt; <span style="color: #555555;">  2. </span>│ <span style="color: #949494;">└─base (local) tryCatchList(expr, classes, parentenv, handlers)</span></span></span>
<span><span class="co">#&gt; <span style="color: #555555;">  3. </span>│   <span style="color: #949494;">└─base (local) tryCatchOne(expr, names, parentenv, handlers[[1L]])</span></span></span>
<span><span class="co">#&gt; <span style="color: #555555;">  4. </span>│     <span style="color: #949494;">└─base (local) doTryCatch(return(expr), name, parentenv, handler)</span></span></span>
<span><span class="co">#&gt; <span style="color: #555555;">  5. </span>└─<span style="font-weight: bold;">wddsWizard</span>::wdds_to_dcmi(...)</span></span>
<span><span class="co">#&gt; <span style="color: #555555;">  6. </span>  └─<span style="font-weight: bold;">purrr</span>::imap(...)</span></span>
<span><span class="co">#&gt; <span style="color: #555555;">  7. </span>    └─purrr::map2(.x, vec_index(.x), .f, ...)</span></span>
<span><span class="co">#&gt; <span style="color: #555555;">  8. </span>      └─purrr:::map2_("list", .x, .y, .f, ..., .progress = .progress)</span></span>
<span><span class="co">#&gt; <span style="color: #555555;">  9. </span>        ├<span style="color: #949494;">─purrr:::with_indexed_errors(...)</span></span></span>
<span><span class="co">#&gt; <span style="color: #555555;"> 10. </span>        │ <span style="color: #949494;">└─</span><span style="color: #949494; font-weight: bold;">base</span><span style="color: #949494;">::withCallingHandlers(...)</span></span></span>
<span><span class="co">#&gt; <span style="color: #555555;"> 11. </span>        ├<span style="color: #949494;">─</span><span style="color: #949494; font-weight: bold;">purrr</span><span style="color: #949494;">:::call_with_cleanup(...)</span></span></span>
<span><span class="co">#&gt; <span style="color: #555555;"> 12. </span>        └─<span style="font-weight: bold;">wddsWizard</span> (local) .f(.x[[i]], .y[[i]], ...)</span></span>
<span><span class="co">#&gt; <span style="color: #555555;"> 13. </span>          └─wddsWizard::translate_to_dcmi(item = item, translation_map = x)</span></span>
<span><span class="co">#&gt; <span style="color: #555555;"> 14. </span>            └─<span style="font-weight: bold;">purrr</span>::map(...)</span></span>
<span><span class="co">#&gt; <span style="color: #555555;"> 15. </span>              └─purrr:::map_("list", .x, .f, ..., .progress = .progress)</span></span>
<span><span class="co">#&gt; <span style="color: #555555;"> 16. </span>                ├<span style="color: #949494;">─purrr:::with_indexed_errors(...)</span></span></span>
<span><span class="co">#&gt; <span style="color: #555555;"> 17. </span>                │ <span style="color: #949494;">└─</span><span style="color: #949494; font-weight: bold;">base</span><span style="color: #949494;">::withCallingHandlers(...)</span></span></span>
<span><span class="co">#&gt; <span style="color: #555555;"> 18. </span>                ├<span style="color: #949494;">─</span><span style="color: #949494; font-weight: bold;">purrr</span><span style="color: #949494;">:::call_with_cleanup(...)</span></span></span>
<span><span class="co">#&gt; <span style="color: #555555;"> 19. </span>                └─<span style="font-weight: bold;">wddsWizard</span> (local) .f(.x[[i]], ...)</span></span>
<span><span class="co">#&gt; <span style="color: #555555;"> 20. </span>                  └─<span style="color: #5555FF; font-weight: bold;">wddsWizard::wdds_to_dcmi(</span>metadata_to_translate = x, translation_map = translation_map<span style="color: #5555FF; font-weight: bold;">)</span></span></span></code></pre></div>
<p>The license abbreviation we used “CC0” is not one that is accepted by
Zenodo. To see all the licenses accepted by Zenodo, check out
<code><a href="../reference/spdx_licenses.html">wddsWizard::spdx_licenses</a></code>.</p>
<p>Lets update the <code>rights</code> property and see if our
conversion works.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">project_metadata_prepped</span><span class="op">$</span><span class="va">rights</span><span class="op">$</span><span class="va">rights</span> <span class="op">&lt;-</span> <span class="st">"CC0-1.0"</span></span>
<span></span>
<span><span class="va">dcmi_metadata</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/wdds_to_dcmi.html">wdds_to_dcmi</a></span><span class="op">(</span>metadata_to_translate <span class="op">=</span> <span class="va">project_metadata_prepped</span>, translation_map <span class="op">=</span> <span class="va">wdds_to_dcmi_map</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="getting-started-with-deposits">Getting started with deposits<a class="anchor" aria-label="anchor" href="#getting-started-with-deposits"></a>
</h3>
<p>Now lets make a deposit in Zenodo using the deposits package.</p>
<p>The basic workflow looks like this:</p>
<ol style="list-style-type: decimal">
<li>Connect to Zenodo server</li>
<li>Create a DRAFT deposit</li>
<li>Upload files to DRAFT deposit</li>
<li>Review metadata and data</li>
<li>Publish deposit</li>
</ol>
<p>Zenodo provides two sites - production and sandbox. The production
site mints real DOIs and is where you ultimately want your data to be
deposited. The sandbox site provides a testing ground for you to
practice depositing data.</p>
<p>Both sites require an API key in order to programmatically create
deposits. Treat this key with extreme care because it allows access to
your Zenodo account. - <a href="https://sandbox.zenodo.org/account/settings/applications/tokens/new/" class="external-link">Sandbox
API Key</a> - <a href="https://zenodo.org/account/settings/applications/tokens/new/" class="external-link">Production
API Key</a></p>
<p>These can be stored securely in a number of ways, we will use the
<code>.Renviron</code> file so that keys are not hard-coded into your
scripts.</p>
<pre><code><span><span class="fu">usethis</span><span class="fu">::</span><span class="fu">edit_r_environ</span><span class="op">(</span><span class="op">)</span></span></code></pre>
<p>Your <code>.Renviron</code> file should look something like the
example below. Remember that the file always has to end in a blank
return.</p>
<pre><code><span><span class="va">ZENODO_SANDBOX_TOKEN</span><span class="op">=</span><span class="st">"TokenFromZenodoSandbox"</span></span>
<span><span class="va">ZENODO_TOKEN</span><span class="op">=</span><span class="st">"TokenFromZenodoProduction"</span></span></code></pre>
<p>After you’ve added the tokens to your environment, restart your R
session.</p>
</div>
<div class="section level3">
<h3 id="create-deposit">Create deposit<a class="anchor" aria-label="anchor" href="#create-deposit"></a>
</h3>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/conditions.html" class="external-link">tryCatch</a></span><span class="op">(</span></span>
<span><span class="fu">deposits</span><span class="fu">::</span><span class="va"><a href="https://docs.ropensci.org/deposits/reference/depositsClient.html" class="external-link">depositsClient</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span>service <span class="op">=</span> <span class="st">"zenodo"</span>,metadata <span class="op">=</span> <span class="va">dcmi_metadata</span>,sandbox <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>  error <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">e</span><span class="op">)</span><span class="op">{</span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">e</span><span class="op">)</span><span class="op">}</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt;   instancePath                                  schemaPath keyword</span></span>
<span><span class="co">#&gt; 1     /created #/properties/created/anyOf/0/anyOf/0/format  format</span></span>
<span><span class="co">#&gt; 2     /created #/properties/created/anyOf/0/anyOf/1/format  format</span></span>
<span><span class="co">#&gt; 3     /created          #/properties/created/anyOf/0/anyOf   anyOf</span></span>
<span><span class="co">#&gt; 4     /created           #/properties/created/anyOf/1/type    type</span></span>
<span><span class="co">#&gt; 5     /created                  #/properties/created/anyOf   anyOf</span></span>
<span><span class="co">#&gt;   params.format params.type                       message</span></span>
<span><span class="co">#&gt; 1          date        &lt;NA&gt;      must match format "date"</span></span>
<span><span class="co">#&gt; 2     date-time        &lt;NA&gt; must match format "date-time"</span></span>
<span><span class="co">#&gt; 3          &lt;NA&gt;        &lt;NA&gt;  must match a schema in anyOf</span></span>
<span><span class="co">#&gt; 4          &lt;NA&gt;      object                must be object</span></span>
<span><span class="co">#&gt; 5          &lt;NA&gt;        &lt;NA&gt;  must match a schema in anyOf</span></span>
<span><span class="co">#&gt; &lt;simpleError: Stopping because the DCMI metadata terms listed above do not conform with the expected schema.&gt;</span></span></code></pre></div>
<p>Oh no! there is an issue with the <code>created</code> property. It
would appear that its not a properly formatted date!</p>
<p>Looking at the <a href="https://developers.zenodo.org/#representation" class="external-link">dev guide</a> on
Zenodo we can see that dates are supposed to be in ISO8601 so we need to
use a <code>YYYY-MM-DD</code> format.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># After reviewing my records, I realized we created this data on pi day.</span></span>
<span><span class="va">dcmi_metadata</span><span class="op">$</span><span class="va">created</span> <span class="op">&lt;-</span> <span class="st">"2022-03-14"</span></span>
<span></span>
<span><span class="va">cli</span> <span class="op">&lt;-</span> <span class="fu">deposits</span><span class="fu">::</span><span class="va"><a href="https://docs.ropensci.org/deposits/reference/depositsClient.html" class="external-link">depositsClient</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span>service <span class="op">=</span> <span class="st">"zenodo"</span>,metadata <span class="op">=</span> <span class="va">dcmi_metadata</span>,sandbox <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">cli</span><span class="op">$</span><span class="fu">deposit_new</span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">cli</span><span class="op">$</span><span class="fu">deposit_upload_file</span><span class="op">(</span><span class="st">"data/disease_data.csv"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">cli</span><span class="op">$</span><span class="va">deposits</span><span class="op">$</span><span class="va">links</span><span class="op">$</span><span class="va">html</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span></code></pre></div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Collin Schwantes.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
